---
language: python
python:
  - "2.7"
# command to install dependencies
jobs:
  include:
    - stage: code-quality
      install:
        - pip install flake8
      # command to run tests
      script:
        - python -m flake8 --statistics --count --ignore E722,E501 bin/jinja-render.py 
    - stage: test-installation
      script: 
        - pip install .
        - inetsix-config-builder -h
    - stage: test-run
      script: 
        - pip install git+https://github.com/titom73/inetsix-config-builder
        - inetsix-config-builder -t tests/template.j2 -y tests/data.yaml
        - cat generated-config.conf
    - stage: pypi-deploy
      name: Push package to pypi servers
      script:
      - echo "deploy to pypi.org"
      deploy:
        provider: pypi
        username: titom73
        skip_existing: true
        password:
          secure: secure: "i2aIIEtvvCdgETr54UPYXkUI4Ebqjqc1b6z+sVBJPVpsmLCgwVXrwNGOc5xlDwMYiTmDyEX8t2Njo1VzBxiTSSosPJPl5eBf0Gow5Xk95zplmyLjg8shwIYO6JHlISKSSyu++nEwJm8rpH08L23Wmlk+q+vUnecIW0oF5vPYbEOgKlCeH5FqlwCLDTKE11i9aMqQRtXqlvMtSM9GA7OVpMkA3nE/knlYpZiloERAfvsSwVIBC7PaXdgnnOJe/dj0Q69K4s16/9kKR4LC2YrdediQmklqoVPtt4gBsD9I9IZD91YWvteWU0hHaAbBxn6mWdgxEniJRQ2uiu73+SfiYGOcEELHJ91UGAz0f3hxcPd3A90DY8f40YYnoInljlkP+YUsmuBbWhdCTvYkzto2wMmUl+0SK9VmEVEtCmlI7y3P5BRwGOFOQrV9yy8MpSyDzvtbHkFMhJw4+PSKc7rrQjPhIGwJ15a+sL37I3YaZKgUoPz9YC+qDLjDacKkQI4UWzFfBlM0um5XKK1dGmH9ucUeB1R4cM0+sw0PoxFeomqX16Zsk9Byx7yJcCCJHftiUNXd/sOXUWBmLqF19ZvzbNROqsOLE11RvDmKEqRDe7vslU5GHY7DTRAP/Sw1IcSVb4cAqNvDr480ql8IjXL6iloBXgG1yJruZfqN8XWqJEc="
        on:
          tags: true
          distributions: sdist bdist_wheel
          repo: titom73/inetsix-config-builder